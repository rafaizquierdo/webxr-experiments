<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Escala Real: SpaceX Starship</title>
    <meta name="description" content="Experiencia de escala real de cohetes espaciales en VR">
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
        <script>
      // Componente personalizado para movimiento con thumbstick VR
      AFRAME.registerComponent('thumbstick-logging', {
        init: function () {
          this.el.addEventListener('thumbstickmoved', this.logThumbstick);
        },
        logThumbstick: function (evt) {
          if (evt.detail.y > 0.1 || evt.detail.y < -0.1) {
            const rig = document.querySelector('#rig');
            const camera = document.querySelector('a-camera');
            const direction = new THREE.Vector3();
            camera.object3D.getWorldDirection(direction);
            direction.y = 0;
            direction.normalize();
            const speed = evt.detail.y * -0.1;
            rig.object3D.position.add(direction.multiplyScalar(speed));
          }
        }
      });
      
      // Componente para controles de teclado mejorados
      AFRAME.registerComponent('keyboard-controls', {
        schema: {
          acceleration: {default: 65}
        },
        init: function () {
          this.velocity = new THREE.Vector3();
          this.keys = {};
          
          window.addEventListener('keydown', (e) => {
            this.keys[e.key.toLowerCase()] = true;
          });
          
          window.addEventListener('keyup', (e) => {
            this.keys[e.key.toLowerCase()] = false;
          });
        },
        tick: function (time, delta) {
          const camera = document.querySelector('a-camera');
          const direction = new THREE.Vector3();
          const speed = this.data.acceleration * (delta / 1000);
          
          if (this.keys['w'] || this.keys['arrowup']) {
            camera.object3D.getWorldDirection(direction);
            direction.y = 0;
            direction.normalize();
            this.el.object3D.position.add(direction.multiplyScalar(speed));
          }
          if (this.keys['s'] || this.keys['arrowdown']) {
            camera.object3D.getWorldDirection(direction);
            direction.y = 0;
            direction.normalize();
            this.el.object3D.position.add(direction.multiplyScalar(-speed));
          }
          if (this.keys['a'] || this.keys['arrowleft']) {
            camera.object3D.getWorldDirection(direction);
            direction.y = 0;
            direction.normalize();
            direction.cross(new THREE.Vector3(0, 1, 0));
            this.el.object3D.position.add(direction.multiplyScalar(-speed));
          }
          if (this.keys['d'] || this.keys['arrowright']) {
            camera.object3D.getWorldDirection(direction);
            direction.y = 0;
            direction.normalize();
            direction.cross(new THREE.Vector3(0, 1, 0));
            this.el.object3D.position.add(direction.multiplyScalar(speed));
          }
        }
      });
    </script>
  </head>
  <body>
    <a-scene>
      <!-- MODELO 3D STARSHIP COMPLETO A ESCALA REAL -->
      <a-entity 
        gltf-model="url(spacex_starship_ship_24__booster_7_v4-v2.glb)" 
        position="0 0 -50"
        rotation="0 0 0"
        scale="1 1 1">
      </a-entity>
      
      <!-- PERSONA DE REFERENCIA (1.75m de altura) -->
      <!-- Cuerpo -->
      <a-box 
        position="-15 0.9 -50" 
        width="0.5" 
        height="1.8" 
        depth="0.3" 
        color="#FF6B6B">
      </a-box>
      <!-- Cabeza -->
      <a-sphere 
        position="-15 1.95 -50" 
        radius="0.15" 
        color="#FFD93D">
      </a-sphere>
      
      <!-- ETIQUETA PERSONA -->
      <a-text 
        value="PERSONA: 1.75m" 
        position="-15 2.5 -50" 
        align="center" 
        color="#FFFFFF" 
        width="8">
      </a-text>
      
      <!-- ETIQUETA STARSHIP -->
      <a-text 
        value="STARSHIP\n120 metros" 
        position="0 130 -50" 
        align="center" 
        color="#FFFFFF" 
        width="15">
      </a-text>
      
      <!-- LÍNEA DE ALTURA STARSHIP -->
      <a-box 
        position="8 60 -50" 
        width="0.1" 
        height="120" 
        depth="0.1" 
        color="#00FF00">
      </a-box>
      
      <!-- MARCAS DE ESCALA cada 10 metros -->
      <a-text value="0m" position="9 0 -50" color="#00FF00" width="4"></a-text>
      <a-text value="10m" position="9 10 -50" color="#00FF00" width="4"></a-text>
      <a-text value="20m" position="9 20 -50" color="#00FF00" width="4"></a-text>
      <a-text value="30m" position="9 30 -50" color="#00FF00" width="4"></a-text>
      <a-text value="40m" position="9 40 -50" color="#00FF00" width="4"></a-text>
      <a-text value="50m" position="9 50 -50" color="#00FF00" width="4"></a-text>
      <a-text value="60m" position="9 60 -50" color="#00FF00" width="4"></a-text>
      <a-text value="70m" position="9 70 -50" color="#00FF00" width="4"></a-text>
      <a-text value="80m" position="9 80 -50" color="#00FF00" width="4"></a-text>
      <a-text value="90m" position="9 90 -50" color="#00FF00" width="4"></a-text>
      <a-text value="100m" position="9 100 -50" color="#00FF00" width="4"></a-text>
      <a-text value="110m" position="9 110 -50" color="#00FF00" width="4"></a-text>
      <a-text value="120m" position="9 120 -50" color="#00FF00" width="4"></a-text>
      
      <!-- SUELO (plataforma de lanzamiento) -->
      <a-plane 
        position="0 0 -50" 
        rotation="-90 0 0" 
        width="200" 
        height="200" 
        color="#2C3E50">
      </a-plane>
      
      <!-- GRID en el suelo para referencia de distancia -->
      <a-entity position="0 0.05 -50">
        <a-box position="-20 0 0" width="0.2" height="0.1" depth="100" color="#FFFFFF" opacity="0.3"></a-box>
        <a-box position="20 0 0" width="0.2" height="0.1" depth="100" color="#FFFFFF" opacity="0.3"></a-box>
        <a-box position="0 0 -20" width="100" height="0.1" depth="0.2" color="#FFFFFF" opacity="0.3"></a-box>
        <a-box position="0 0 20" width="100" height="0.1" depth="0.2" color="#FFFFFF" opacity="0.3"></a-box>
      </a-entity>
      
      <!-- CIELO -->
      <a-sky color="#87CEEB"></a-sky>
      
      <!-- CÁMARA con controles de movimiento -->
      <!-- RIG COMPLETO: Cámara + Controles para VR y Desktop -->
      <a-entity id="rig" 
                position="0 0 0"
                keyboard-controls>
        
        <!-- Cámara principal con mirada libre -->
        <a-camera 
          position="0 1.6 0"
          look-controls="pointerLockEnabled: true">
          
          <!-- Cursor para interacciones -->
          <a-cursor></a-cursor>
        </a-camera>
        
        <!-- Mano izquierda (controlador VR) -->
        <a-entity 
          hand-controls="hand: left"
          thumbstick-logging>
        </a-entity>
        
        <!-- Mano derecha (controlador VR) -->
        <a-entity 
          hand-controls="hand: right"
          thumbstick-logging>
        </a-entity>
        
      </a-entity></a-entity>
    </a-scene>
  </body>
</html>
